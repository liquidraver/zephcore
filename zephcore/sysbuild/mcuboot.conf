# MCUboot Configuration for ESP32
# Minimal footprint — OTA only, no serial recovery, no logging.

# Overwrite-only mode (no swap, no scratch partition needed)
# Matches Arduino ElegantOTA behavior (no rollback)
CONFIG_BOOT_UPGRADE_ONLY=y

# Let MCUboot auto-calculate sector count from partition size
CONFIG_BOOT_MAX_IMG_SECTORS_AUTO=y

# Minimize size — no serial recovery
CONFIG_BOOT_SERIAL_CDC_ACM=n
CONFIG_SIZE_OPTIMIZATIONS=y

# Temporary: enable logging for debug
CONFIG_SERIAL=y
CONFIG_UART_CONSOLE=y
CONFIG_CONSOLE=y
CONFIG_MCUBOOT_LOG_LEVEL_INF=y
CONFIG_LOG_DEFAULT_LEVEL=3

# MCUboot doesn't need SPI — ESP32 uses internal flash controller.
# Disable to avoid spi_context build errors with minimal threading config.
CONFIG_SPI=n

# ESP32 HAL's mcuboot_config.h is patched (patches/modules/hal/espressif/...)
# to respect Zephyr Kconfig: mbedTLS detection, AUTO sector count, slot0 validation.
